{php include wl_template('common/header');}
<ul class="nav nav-tabs">
	<li class="active"><a href="#">粉丝列表</a></li>
</ul>
<div class="panel">
	    <div class="panel-body">
            <form action="" method="get" class="form-horizontal" role="form" id="form1">
                <input type="hidden" name="c" value="site" />
	            <input type="hidden" name="a" value="entry" />
	            <input type="hidden" name="m" value="weliam_merchant" />
	            <input type="hidden" name="p" value="member" />
				<input type="hidden" name="ac" value="wlMember" />
				<input type="hidden" name="do" value="memberIndex" />
				<input type="hidden" name="vipstatus" value="{$_GPC['vipstatus']}" />
                <div class="form-group">
                	<div class="col-md-4">
					<div class="btn-group">
						<a href="{php echo web_url('member/wlMember/memberIndex',array('vipstatus'=>0))}" class="btn {if empty($_GPC['vipstatus'])}btn-primary{else}btn-default{/if}">粉丝</a>
						<a href="{php echo web_url('member/wlMember/memberIndex',array('vipstatus'=>1))}" class="btn {if $_GPC['vipstatus']==1}btn-primary{else}btn-default{/if}">Vip</a>
					</div>
				</div>
                    <div class="col-md-2">
                        <select name="type" class="form-control">
						<option value="2" {if $_GPC['type'] == 2}selected{/if}>手机号</option>
						<option value="3" {if $_GPC['type'] == 3}selected{/if}>真实姓名</option>
						<option value="4" {if $_GPC['type'] == 4}selected{/if}>昵称</option>
					</select>
                    </div>
                    <div class="col-md-6 pull-right">
						<div class="input-group">
							<input type="text" name="keyword" class="form-control" value="{$_GPC['keyword']}"  placeholder="请输入关键字"/>
							<span class="input-group-addon" id="search">搜索</span>
						</div>
					</div>
				</div>
            </form>
	    </div>
	</div>
	<script type="text/javascript">
		$("#search").click(function(){
			$('#form1')[0].submit();
		});
	</script>
<div class="panel panel-default">
	<div class="table-responsive">
		<table class="table table-hover">
			<thead class="navbar-inner">
				<tr>
					<th style="width:20px;">
					<input type="checkbox" name="checkall" value="" id="checkall" onclick="var ck = this.checked; $(':checkbox').each(function(){this.checked = ck});"/>
				</th>
					<th style="width:150px;text-align: left;">粉丝信息</th>
					<th style="width:110px;text-align: left;">会员信息</th>
					<th style="width:100px;text-align: left;">等级/地区</th>
					<th style="width:100px;text-align: left;">交易</th>
					<th style="width:100px;">关注</th>
					<th style="width:100px;text-align: left;">积分/余额</th>
					<th style="width:160px;" class="text-center">操作</th>
				</tr>
			</thead>
			{loop $list $li}
			<tbody >
				<tr id="{$li['uid']}">
					<td><input type="checkbox" name="items[]" value="{$goods['id']}" class="items" /></td>
					<td style="text-align: left;">
						<img class="scrollLoading" src="{IMAGE_PIXEL}" data-url="{$li['avatar']}" onerror="this.src='{IMAGE_NOPIC_SMALL}'" height="40" width="40"/>{$li['nickname']}
					</td>
					<td style="text-align: left;">{$li['mobile']}<br>{$li['realname']}</td>
					<td style="text-align: left;"><span class="label label-danger">等级：{$li['level']}</span><br/><span class="label label-info">地区：{$li['areaid']}</span></td>
					<td style="text-align: left;"><span class="label label-success">成交量：{$li['dealnum']}</span><br><span class="label label-success">成交额：{$li['dealmoney']}</span></td>
					<td>{if $li['follow']==1}<span class="label label-primary">已关注</span>{else}<span class="label label-default">未关注</span>{/if}</td>
					<td style="text-align: left;"><span class="label label-warning">积分：{$li['credit1']}</span><br><span class="label label-warning">余额：{$li['credit2']}</span></td>
					<td >
						<a style="color: #428BCA;" href="javascript:void(0)"  class="js-recharge" uid="{$li['uid']}" realname="{$li['realname']}" mobile="{$li['mobile']}" title="充值" onclick="popwin = $('#modal-module-goodshouse').modal();">设置</a> -
						<a style="color: #428BCA;" href="{php echo web_url('member/wlMember/creditRecord', array('uid' => $li['uid']))}">变更历史</a>
					</td>
				</tr>
			
			</tbody>
			<script>
				function seeLevel(){
					layer.open({
					  type: 1
					  ,title: false //不显示标题栏
					  ,closeBtn: false
					  ,area: '400px;'
					  ,shade: 0.8
					  ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
					  ,btn: ['关闭']
					  ,moveType: 1 //拖拽模式，0或者1
					  ,content: '<div style="padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">'+
					  			'<div style="font-size:20px;text-align: center;">会员等级</div>'+
					  			'<br>账号类型：{if $li['isvip']==1}VIP{elseif $li['isvip']==0}普通账号{/if}<br>'+
					  			'<br>到期时间：{php echo date("y-m-d",$li[vipendtime])}<br>'+
					  			
					  			'</div>'
					  ,success: function(layero){
					    var btn = layero.find('.layui-layer-btn');
					    btn.css('text-align', 'center');
					  }
					});
				}
			</script>
			{/loop}
		</table>
	</div>
</div>
{$pager}
<div id="modal-module-goodshouse" class="modal fade" tabindex="-1">
			<div class="modal-dialog" style='width: 920px;'>
				<div class="modal-content">
					<div class="modal-header">
						<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
						<h3>会员操作</h3></div>
					<div class="modal-body">
				<style>
					.table{margin-bottom: 0}
					.table td, .table th{text-align: center;}
				</style>
				<form class="table-responsive" method="post" action="" id="form1">
					<input type="hidden" name="uid" value="">
					
					<table class="table table-hover table-bordered">
						<tbody>
							<tr>
								<th>积分</th>
								<td>
									<label class="radio-inline"><input type="radio" name="credit1_type" value="1" checked=""> 增加</label>
									<label class="radio-inline"><input type="radio" name="credit1_type" value="2"> 减少</label>
								</td>
								<td colspan="2">
									<input type="text" name="credit1_value" value="0" class="form-control">
								</td>
							</tr>
							<tr>
								<th>余额</th>
								<td>
									<label class="radio-inline"><input type="radio" name="credit2_type" value="1" checked=""> 增加</label>
									<label class="radio-inline"><input type="radio" name="credit2_type" value="2"> 减少</label>
								</td>
								<td colspan="2">
									<input type="text" name="credit2_value" value="0" class="form-control">
								</td>
							</tr>
							<!--<tr>
								<th>真实姓名</th>
								<td><input type="text" name="realname" id="realname" /></td>
								<th>电话号码</th>
								<td><input type="tel" name="telnum" id="telnum" /></td>
							</tr>-->
							<!--<tr>
								<th>设置VIP</th>
								<td colspan="3">
									<label class="radio-inline"><input type="radio" name="level" value="1"> VIP1</label>
									<label class="radio-inline"><input type="radio" name="level" value="2"> VIP2</label>
									<label class="radio-inline"><input type="radio" name="level" value="3"> VIP3</label>
								</td>
							</tr>-->
							<!--<tr>
								<th>操作备注</th>
								<td colspan="3">
									<textarea class="form-control" name="remark"></textarea>
								</td>
							</tr>-->
						</tbody>
					</table>
				</form>
				<div class="modal-footer">
					<span name="submit" id="submit" class="pull-right btn btn-primary" uid="" data-dismiss="modal" aria-hidden="true">保存</span>
					<input type="hidden" name="token" value="{$_W['token']}" />
				</div>
			</div>
				</div>

			</div>
		</div>
<script>
	$(function(){
		$(".scrollLoading").scrollLoading();
		var $pop = null;
		$('.scrollLoading').hover(function(){
			var img = $(this).attr('src');
			var obj = this;
			var $pop = util.popover(obj, function($popover, obj){
				obj.$popover = $popover;
			}, '<div><img src="'+img+'" style="max-width:200px; max-height:200px;"></div>');
		}, function(){
			this.$popover.remove();
		});
		
		$('.js-recharge').click(function() {
			var uid = $(this).attr('uid');
			if(uid==''){util.tips("非关注会员不能充值!!");return false;}
			$('#submit').attr("uid",uid);
		});
		
		$('#submit').click(function() {
			var uid = $(this).attr('uid');
			var credit1_type = $("input[name='credit1_type']:checked").val();
			var credit1_value = $("input[name='credit1_value']").val();
			var credit2_type = $("input[name='credit2_type']:checked").val();
			var credit2_value = $("input[name='credit2_value']").val();
			var remark = $("textarea[name='remark']").val();
			var realname = $('#realname').val();
			var telnum = $('#telnum').val();
			var level =  $("input[name='level']:checked").val();
			$.post("{php echo web_url('member/wlMember/modal')}",{level:level,remark:remark,uid:uid,credit1_type:credit1_type,credit1_value:credit1_value,credit2_type:credit2_type,credit2_value:credit2_value,realname:realname,telnum:telnum},function(d){
				
				if(!d.errno){
					$('#credit1'+uid).html(d.credit1);
					$('#credit2'+uid).html(d.credit2);
					$('#'+uid+'name').text(d.newname);
					$('#'+uid+'tel').text(d.newtel);
				}
				util.tips(d.message);
				setTimeout("location.reload()",1000);
			},"json");
			$('#modal-message').hide();
			$('.panel').css("opacity","1");$('.nav').css("opacity","1");$('.pagination').css("opacity","1");
		});
		
	});
</script>
{php include wl_template('common/footer');}
